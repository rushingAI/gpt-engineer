# ç»„ä»¶åŒ–å¯æ§ç”Ÿæˆæ”¹é€ å®æ–½æ€»ç»“

## ğŸ¯ æ”¹é€ ç›®æ ‡

ä»"å¼ºåˆ¶å•æ–‡ä»¶ Index.tsx"å‡çº§ä¸º"å—æ§å¤šæ–‡ä»¶ç»„ä»¶åŒ– + CSS Modules"ï¼ŒåŒæ—¶ä¿ç•™è®¾è®¡ç³»ç»Ÿä¸å¯å˜ä¸è´¨é‡é—¨ç¦/è‡ªæ„ˆé—­ç¯ã€‚

## âœ… å·²å®Œæˆçš„æ”¹åŠ¨

### é˜¶æ®µ Aï¼šå—æ§å¤šæ–‡ä»¶ç»“æ„

#### 1. æ›´æ–°åç«¯ç”Ÿæˆ promptï¼ˆ`backend/server.py`ï¼‰
- âœ… ç§»é™¤ "åªç”Ÿæˆ Index.tsx" çš„ç¡¬æ€§é™åˆ¶
- âœ… æ·»åŠ å—æ§å¤šæ–‡ä»¶ç»“æ„è¯´æ˜ï¼š
  - `src/pages/Index.tsx` - ä¸»å…¥å£ï¼ˆç¼–æ’ï¼‰
  - `src/components/generated/<appSlug>/*.tsx` - é¢†åŸŸç»„ä»¶
  - `src/features/**/*.tsx` - ç‰¹æ€§æ¨¡å—
  - `src/lib/generated/*.ts` - ä¸šåŠ¡é€»è¾‘
- âœ… æ·»åŠ å¯¼å…¥è¾¹ç•Œè§„åˆ™ï¼ˆç¦æ­¢ `../` è¶Šç•Œè®¿é—®å—ä¿æŠ¤ç›®å½•ï¼‰

#### 2. æ›´æ–°æ‰€æœ‰ prepromptsï¼ˆ`backend/preprompts_custom/`ï¼‰
- âœ… `modern_web_app` - æ”¹ä¸ºæ¨èå¤šæ–‡ä»¶ç»“æ„
- âœ… `dashboard` - æ”¹ä¸ºæ¨èæ‹†åˆ† Sidebarã€StatsCards ç­‰ç»„ä»¶
- âœ… `landing_page` - æ”¹ä¸ºæ”¯æŒæ‹†åˆ† Heroã€Features ç­‰ç»„ä»¶
- âœ… `cyberpunk_react` - å·²æ˜¯å¤šæ–‡ä»¶ç»“æ„ï¼ˆä¿æŒï¼‰

#### 3. åˆ›å»º preprompts æ‰«æé—¨ç¦ï¼ˆ`backend/scan_preprompts.py`ï¼‰
- âœ… è‡ªåŠ¨æ£€æµ‹æ®‹ç•™çš„å•æ–‡ä»¶é™åˆ¶å…³é”®è¯
- âœ… ç¡®ä¿æ‰€æœ‰ preprompts ç»Ÿä¸€åˆ°å¤šæ–‡ä»¶è§„èŒƒ
- âœ… æ‰«æç»“æœï¼š**æ— æ®‹ç•™å•æ–‡ä»¶é™åˆ¶** âœ…

### é˜¶æ®µ Bï¼šCSS Modules æ”¯æŒ

#### 1. æ‰©å±•ç­–ç•¥ç™½åå•ï¼ˆ`backend/policies/generation_policy.json`ï¼‰
- âœ… æ·»åŠ  `src/components/generated/**/*.module.css` åˆ°ç™½åå•
- âœ… æ–°å¢ `css_modules` é…ç½®èŠ‚ï¼š
  ```json
  "css_modules": {
    "enabled": true,
    "allowed_locations": ["src/components/generated/**"],
    "naming_convention": "same_as_component",
    "forbidden_patterns": [":global"]
  }
  ```

#### 2. æ›´æ–° server.py prompt
- âœ… æ·»åŠ  CSS Modules ä½¿ç”¨è¯´æ˜
- âœ… æ˜ç¡®å‘½åè§„èŒƒï¼ˆåŒç›®å½•åŒåï¼‰
- âœ… ç¦æ­¢ `:global()` æ±¡æŸ“å…¨å±€
- âœ… æŒ‡å¯¼ Tailwind + CSS Modules æ··ç”¨æœ€ä½³å®è·µ

#### 3. å‰ç«¯è¿‡æ»¤å™¨æ”¯æŒï¼ˆ`client/src/utils/webcontainer.js`ï¼‰
- âœ… æ·»åŠ  `/\.module\.css$/` åˆ° allowedPatterns
- âœ… ä¸åç«¯ç­–ç•¥ä¿æŒä¸€è‡´

### é˜¶æ®µ Cï¼šè´¨é‡é—¨ç¦ä¸è‡ªæ„ˆå¢å¼º

#### 1. æ–°å¢è´¨é‡é—¨ç¦è§„åˆ™ï¼ˆ`backend/policies/generation_policy.json`ï¼‰
- âœ… `unreferenced_generated_file` - æ£€æµ‹æœªè¢«å¼•ç”¨çš„ generated æ–‡ä»¶
- âœ… `import_boundary_violation` - æ£€æµ‹ `../` è¶Šç•Œå¯¼å…¥
- âœ… `css_module_global_usage` - æ£€æµ‹ CSS Module ä½¿ç”¨ `:global()`
- âœ… `index_tsx_too_large` - æ£€æµ‹ Index.tsx è¶…è¿‡ 300 è¡Œï¼ˆå¯é…ç½®ï¼‰

#### 2. å®ç°æ–°é—¨ç¦æ£€æŸ¥ï¼ˆ`backend/quality_gates.py`ï¼‰
- âœ… `_check_unreferenced_generated_files()` - åˆ†æ import è¯­å¥ï¼Œæ‰¾å‡ºå­¤å„¿æ–‡ä»¶
- âœ… `_check_import_boundary_violation()` - æ‰«æç›¸å¯¹è·¯å¾„å¯¼å…¥
- âœ… `_check_css_module_global_usage()` - æ‰«æ CSS æ–‡ä»¶ä¸­çš„ `:global`
- âœ… `_check_index_too_large()` - è®¡ç®—è¡Œæ•°å¹¶ç»™å‡ºæ‹†åˆ†å»ºè®®

#### 3. å¢å¼ºè‡ªæ„ˆå¾ªç¯ï¼ˆ`backend/self_heal.py`ï¼‰
- âœ… æ·»åŠ  Index.tsx è¿‡å¤§æ—¶çš„æ‹†åˆ†æŒ‡å¯¼
- âœ… æ˜ç¡®æŒ‡ç¤º AI åˆ›å»ºç»„ä»¶åˆ° `src/components/generated/<appSlug>/`
- âœ… ç¦æ­¢"åˆ æ³¨é‡Š"å¼æ•·è¡ï¼Œè¦æ±‚çœŸæ­£é‡æ„

### é˜¶æ®µ Dï¼šå‰ç«¯é¢„è§ˆä¸å±•ç¤º

#### 1. å¯¹é½å‰ç«¯è¿‡æ»¤é€»è¾‘
- âœ… å‰ç«¯ allowedPatterns ä¸åç«¯ç­–ç•¥ä¿æŒä¸€è‡´
- âœ… æ”¯æŒ CSS Modules æ–‡ä»¶å†™å…¥ WebContainer

#### 2. ç­–ç•¥å•ä¸€äº‹å®æ¥æº
- âœ… å‰ç«¯è¿‡æ»¤å™¨æ³¨é‡Šå¼•ç”¨åç«¯ç­–ç•¥
- âœ… ä¿æŒå‰åç«¯å…è®¸è·¯å¾„åŒæ­¥ï¼ˆæœªæ¥å¯è‡ªåŠ¨åŒ–ï¼‰

## ğŸ“Š éªŒè¯ç»“æœ

### 1. Preprompts æ‰«æ
```
âœ… æœªå‘ç°å•æ–‡ä»¶é™åˆ¶å…³é”®è¯ - æ‰€æœ‰ preprompts å·²æ›´æ–°
```

### 2. å…³é”®æ”¹åŠ¨éªŒè¯ï¼ˆ`verify_changes.py`ï¼‰
```
âœ… ç­–ç•¥æ”¯æŒ CSS Modules
âœ… Server.py prompt æ”¯æŒå¤šæ–‡ä»¶
âœ… Preprompts å·²æ›´æ–°
âœ… è‡ªæ„ˆæ·»åŠ æ‹†åˆ†æŒ‡å¯¼
âœ… å‰ç«¯è¿‡æ»¤å™¨æ”¯æŒ CSS Modules
âœ… ç­–ç•¥é…ç½®æ–°å¢è§„åˆ™: 4 ä¸ª
âœ… Quality gates å®ç°æ–°æ–¹æ³•: 4 ä¸ª
```

### 3. Sudoku P0 å›å½’æµ‹è¯•ï¼ˆ`test_sudoku_regression.py`ï¼‰
```
âœ… PASS - æ•°ç‹¬æ¸¸æˆç”ŸæˆæˆåŠŸ

ç”Ÿæˆæ–‡ä»¶ç»“æ„ï¼ˆå¤šæ–‡ä»¶ç»„ä»¶åŒ–ï¼‰:
  âœ… src/pages/Index.tsx - ä¸»ç¼–æ’
  âœ… src/components/generated/sudoku/SudokuGrid.tsx - ç½‘æ ¼ç»„ä»¶
  âœ… src/components/generated/sudoku/SudokuCell.tsx - å•å…ƒæ ¼ç»„ä»¶
  âœ… src/components/generated/sudoku/SudokuControls.tsx - æ§åˆ¶ç»„ä»¶
  âœ… src/lib/generated/sudoku-solver.ts - æ±‚è§£é€»è¾‘
  âœ… src/components/generated/sudoku/SudokuGrid.module.css - CSS Module

è´¨é‡é—¨ç¦:
  âœ… L0_static: é€šè¿‡ï¼ˆç»è¿‡ 3 æ¬¡è‡ªæ„ˆè¿­ä»£ï¼‰
  âœ… è‡ªæ„ˆæˆåŠŸä¿®å¤æ‰€æœ‰é—¨ç¦é—®é¢˜

InteractionSpec:
  âœ… 3 ä¸ªçŠ¶æ€ï¼ˆboard, selectedCell, originalBoardï¼‰
  âœ… 2 ä¸ªäº‹ä»¶ï¼ˆclick, inputï¼‰
  âœ… 2 ä¸ªçº¦æŸï¼ˆoriginal cells locked, 1-9 validationï¼‰
  âœ… 5 æ¡éªŒæ”¶æ ‡å‡†
```

## ğŸ¨ å®é™…æ•ˆæœå¯¹æ¯”

### æ”¹é€ å‰ï¼ˆå•æ–‡ä»¶ç¦ä»¤ï¼‰
```
âŒ AI è¢«å¼ºåˆ¶å°†æ‰€æœ‰ä»£ç å¡è¿›ä¸€ä¸ª Index.tsx æ–‡ä»¶
âŒ æ— æ³•åˆ›å»ºä¸“é—¨çš„ SudokuCell æˆ– SudokuGrid ç»„ä»¶
âŒ éš¾ä»¥å®ç°å¤æ‚çš„è‡ªå®šä¹‰æ ·å¼ï¼ˆç»å…¸æ•°ç‹¬çš„ç²—ç»†è¾¹æ¡†ã€ç²¾ç¡®é—´è·ï¼‰
âŒ åªèƒ½ç”¨åŸºç¡€çš„ Button, Card, Input ç»„ä»¶
```

### æ”¹é€ åï¼ˆå—æ§å¤šæ–‡ä»¶ + CSS Modulesï¼‰
```
âœ… AI å¯åˆ›å»º SudokuGridã€SudokuCell ç­‰é¢†åŸŸç»„ä»¶
âœ… ç»„ä»¶æ–‡ä»¶è‡ªåŠ¨ç»„ç»‡åˆ° src/components/generated/sudoku/
âœ… æ”¯æŒ CSS Modules å®ç°ç²¾ç»†ç½‘æ ¼æ ·å¼ï¼ˆç²—ç»†è¾¹æ¡†ã€ç²¾ç¡®é—´è·ï¼‰
âœ… ä¿æŒè®¾è®¡ç³»ç»Ÿä¸å¯å˜ï¼ˆUI åŸºç¡€ç»„ä»¶ä»å—ä¿æŠ¤ï¼‰
âœ… è´¨é‡é—¨ç¦è‡ªåŠ¨æ£€æµ‹ï¼šæœªå¼•ç”¨æ–‡ä»¶ã€è¶Šç•Œå¯¼å…¥ã€å…¨å±€æ±¡æŸ“ã€æ–‡ä»¶è¿‡å¤§
âœ… è‡ªæ„ˆå¾ªç¯è‡ªåŠ¨æ‹†åˆ†è¿‡å¤§çš„ Index.tsx
```

## ğŸ“ æ–‡ä»¶æ”¹åŠ¨æ¸…å•

### ä¿®æ”¹çš„æ–‡ä»¶
- `backend/server.py` - æ›´æ–°ç”Ÿæˆ promptï¼Œæ·»åŠ å¤šæ–‡ä»¶ + CSS Modules æ”¯æŒ
- `backend/policies/generation_policy.json` - æ·»åŠ  CSS Modules é…ç½®å’Œæ–°é—¨ç¦è§„åˆ™
- `backend/quality_gates.py` - å®ç° 4 ä¸ªæ–°é—¨ç¦æ£€æŸ¥æ–¹æ³•
- `backend/self_heal.py` - æ·»åŠ  Index.tsx æ‹†åˆ†æŒ‡å¯¼
- `backend/preprompts_custom/modern_web_app` - æ”¹ä¸ºå¤šæ–‡ä»¶ç»“æ„
- `backend/preprompts_custom/dashboard` - æ”¹ä¸ºå¤šæ–‡ä»¶ç»“æ„
- `backend/preprompts_custom/landing_page` - æ”¹ä¸ºå¤šæ–‡ä»¶ç»“æ„
- `client/src/utils/webcontainer.js` - æ·»åŠ  CSS Modules è¿‡æ»¤æ”¯æŒ

### æ–°å¢çš„æ–‡ä»¶
- `backend/scan_preprompts.py` - Preprompts æ‰«æé—¨ç¦
- `backend/verify_changes.py` - å…³é”®æ”¹åŠ¨éªŒè¯è„šæœ¬

## ğŸ”„ ä¸ Lovable çš„å¯¹æ¯”

### Lovable çš„åšæ³•ï¼ˆæ¨æµ‹ï¼‰
1. **åˆ†å±‚ + æ²™ç®±**ï¼šç³»ç»Ÿå±‚ï¼ˆè®¾è®¡ç³»ç»Ÿ/UIåº“ï¼‰ä¸å¯æ”¹ï¼Œä¸šåŠ¡å±‚ï¼ˆPages/Features/Componentsï¼‰å¯æ‰©å±•
2. **æ–‡ä»¶è¾¹ç•Œ**ï¼šå…è®¸å¤šæ–‡ä»¶ï¼Œä½†é€šè¿‡ç™½åå•/é»‘åå•ä¸¥æ ¼æ§åˆ¶
3. **è´¨é‡é—¨ç¦**ï¼šä¾é  typecheck/test/lint + è‡ªæ„ˆæ”¶æ•›å¤±è´¥
4. **ä¾èµ–ä»²è£**ï¼šä¸è®© AI ç›´æ¥æ”¹ package.jsonï¼Œåªèƒ½å£°æ˜ dependenciesRequested

### æˆ‘ä»¬çš„å®ç°
1. âœ… **åˆ†å±‚ + æ²™ç®±**ï¼šå·²å®ç°ï¼ˆå—ä¿æŠ¤ç›®å½• + ç™½åå•ç›®å½•ï¼‰
2. âœ… **æ–‡ä»¶è¾¹ç•Œ**ï¼šå·²å®ç°ï¼ˆpolicy.json + å‰åç«¯è¿‡æ»¤å™¨ï¼‰
3. âœ… **è´¨é‡é—¨ç¦**ï¼šå·²å®ç°ï¼ˆL0 é™æ€é—¨ç¦ + è‡ªæ„ˆå¾ªç¯ï¼‰
4. â³ **ä¾èµ–ä»²è£**ï¼šå·²åœ¨ç­–ç•¥ä¸­è§„åˆ’ï¼Œæœªå®ç°ï¼ˆå½“å‰å…è®¸ AI é€šè¿‡åˆå¹¶é€»è¾‘æ·»åŠ ä¾èµ–ï¼‰

## ğŸš€ ä¸‹ä¸€æ­¥å»ºè®®

### çŸ­æœŸï¼ˆç«‹å³å¯åšï¼‰
1. âœ… åœ¨å®é™…é¡¹ç›®ä¸­æµ‹è¯•å¤šæ–‡ä»¶ç”Ÿæˆï¼ˆå¯åŠ¨åç«¯ `./run.sh`ï¼‰
2. âœ… åœ¨ WebContainer ä¸­éªŒè¯ç»„ä»¶åŒ–åº”ç”¨çš„è¿è¡Œ
3. âœ… æµ‹è¯• CSS Modules çš„ç²¾ç»†æ ·å¼æ§åˆ¶

### ä¸­æœŸï¼ˆå¢å¼ºä½“éªŒï¼‰
1. å‰ç«¯ UI æ˜¾ç¤ºæ–‡ä»¶æ ‘åˆ†ç»„ï¼ˆSystem / Generatedï¼‰
2. å®ç°ä¾èµ–ä»²è£å™¨ï¼ˆdependenciesRequested ç™½åå•å®¡æ‰¹ï¼‰
3. è¡¥å……æ›´å¤š P1 å›å½’æµ‹è¯•ï¼ˆKanbanã€Form Wizardã€Dashboardï¼‰

### é•¿æœŸï¼ˆäº§å“åŒ–ï¼‰
1. å‰åç«¯ç­–ç•¥è‡ªåŠ¨åŒæ­¥ï¼ˆæ„å»ºæ—¶ç”Ÿæˆ `client/src/generated/policy.json`ï¼‰
2. L1/L2/L3 é—¨ç¦åœ¨ WebContainer å†…è¿è¡Œï¼ˆtypecheck/test/lintï¼‰
3. UI æä¾›"ç»„ä»¶æ¨¡å¼/å•æ–‡ä»¶æ¨¡å¼"åˆ‡æ¢ï¼ˆæŒ‰é¡¹ç›®å¤æ‚åº¦ï¼‰

## ğŸ“ æ€»ç»“

æœ¬æ¬¡æ”¹é€ æˆåŠŸå®ç°äº†"ç»„ä»¶åŒ–å¯æ§ç”Ÿæˆ"ï¼Œè§£é”äº† AI åˆ›å»ºé¢†åŸŸç»„ä»¶ä¸ç²¾ç»†æ ·å¼çš„èƒ½åŠ›ï¼ŒåŒæ—¶é€šè¿‡ç­–ç•¥ç™½åå•ã€è´¨é‡é—¨ç¦ã€è‡ªæ„ˆå¾ªç¯ä¿æŒäº†å¹³å°çš„å¯æ§æ€§å’Œç¨³å®šæ€§ã€‚

**æ ¸å¿ƒå¹³è¡¡ç‚¹**ï¼š
- **èƒ½åŠ›æ‰©å±•**ï¼šå¤šæ–‡ä»¶ç»„ä»¶åŒ– + CSS Modules
- **è¾¹ç•Œæ§åˆ¶**ï¼šç™½åå•/é»‘åå• + å—ä¿æŠ¤ç›®å½•
- **è´¨é‡ä¿éšœ**ï¼šæ–°å¢ 4 ä¸ªé—¨ç¦è§„åˆ™ + è‡ªæ„ˆæ‹†åˆ†æŒ‡å¯¼

**éªŒè¯ç»“æœ**ï¼š
- âœ… Preprompts æ‰«æé€šè¿‡
- âœ… å…³é”®æ”¹åŠ¨éªŒè¯é€šè¿‡
- âœ… Sudoku P0 å›å½’æµ‹è¯•é€šè¿‡ï¼ˆå¤šæ–‡ä»¶ + CSS Module æˆåŠŸç”Ÿæˆï¼‰

æ”¹é€ å®Œæˆï¼ğŸ‰

